import{L as b,P as C,r as g,M as Q,aG as k,aM as _,aH as n,j as V,k as S,l,d as a,a2 as L,a1 as d,N as i,aN as N,K as j,C as p,$ as q,a0 as A,aO as B,aP as M,X as P,U}from"./index.6fdc5749.js";import{a as $,Q as D,C as I}from"./QForm.5493fe23.js";import{Q as O}from"./use-key-composition.c8fffae3.js";import"./use-prevent-scroll.b5993834.js";const R={id:"productView"},E={class:"row flex justify-center",style:{height:"500px",margin:"0 0 110px 0"}},K={class:"product-img col-12 col-lg-3 flex justify-center"},T={class:"flex column no-wrap col-12 col-lg-7"},Y={class:"pre"},F=l("div",{class:"row flex justify-center",style:{height:"400px"}},[l("div",{class:"col-10"},[l("div",{class:"text-h5"},"YOU MAY ALSO LIKE")])],-1),G=l("h5",{class:"text-white text-weight-bold"},"\u8CE3\u5B8C\u310C\u9912",-1),Z={__name:"ProductView",setup(H){const c=N(),m=j(),v=b(),{editCart:h,isLogin:x}=C(v),u=g(0),o=g(!1),f={required(e){return!!e||"\u6B04\u4F4D\u5FC5\u586B"},number(e){return e>0||"\u6578\u91CF\u932F\u8AA4"}},t=Q({_id:"",name:"",price:0,description:"",image:"",images:[],sell:!0,category:""}),y=()=>{h({_id:t._id,quantity:u.value,text:"\u52A0\u5165\u8CFC\u7269\u8ECA"})},w=async()=>{var e,s;try{const{data:r}=await _.post("/users/love",{p_id:c.params.id,love:!o.value});o.value=!o.value,o.value===!0?n.fire({title:"\u52A0\u5165\u6536\u85CF",color:"pink"}):n.fire({title:"\u79FB\u9664\u6536\u85CF",color:"pink"})}catch(r){n.fire({message:"\u5931\u6557",caption:((s=(e=r==null?void 0:r.response)==null?void 0:e.data)==null?void 0:s.message)||"\u767C\u751F\u932F\u8AA4",color:"pink"})}};return(async()=>{try{const{data:e}=await k.get("/products/"+c.params.id);if(t._id=e.result._id,t.name=e.result.name,t.price=e.result.price,t.description=e.result.description,t.image=e.result.image,t.images=e.result.images,t.sell=e.result.sell,t.category=e.result.category,document.title="\u8CFC\u7269\u7DB2 | "+t.name,x.value){const{data:s}=await _.get("/users/love/"+c.params.id);o.value=s.result}}catch{n.fire({icon:"error",title:"\u5931\u6557",text:"\u53D6\u5F97\u5546\u54C1\u5931\u6557"}),m.go(-1)}})(),(e,s)=>(V(),S("div",R,[l("div",E,[l("div",K,[a(L,{src:t.image,cover:"",style:{width:"200px"}},null,8,["src"])]),l("div",T,[l("h3",null,d(t.name),1),l("p",null,"$ "+d(t.price),1),l("p",Y,d(t.description),1),a($,{onSubmit:y},{default:i(()=>[a(D,{filled:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=r=>u.value=r),modelModifiers:{number:!0},type:"number",label:"\u6578\u91CF",rules:[f.required,f.number]},null,8,["modelValue","rules"]),a(p,{type:"submit",color:"primary"},{default:i(()=>[q("\u52A0\u5165\u8CFC\u7269\u8ECA")]),_:1}),a(p,{flat:"",round:"",color:"red",icon:o.value?"fa-solid fa-heart":"fa-regular fa-heart",onClick:s[1]||(s[1]=r=>w({_id:t._id}))},null,8,["icon"])]),_:1})])]),F,a(O,{"v-model":!t.sell,persistent:""},{default:i(()=>[a(A,{class:"bg-accent text-white",style:{width:"300px"}},{default:i(()=>[a(B,null,{default:i(()=>[G]),_:1}),a(M,{class:"bg-white text-accent",align:"right"},{default:i(()=>[P(a(p,{onClick:s[2]||(s[2]=r=>U(m).go(-1)),flat:"",label:"back"},null,512),[[I]])]),_:1})]),_:1})]),_:1},8,["v-model"])]))}};export{Z as default};
