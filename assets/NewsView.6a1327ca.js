import{M as h,aM as p,aH as u,j as x,k as C,l,d as s,C as m,a1 as g,$ as w,N as n,a0 as k,aP as b,X as B,V as D,aO as N,a2 as S,Q as U}from"./index.dabf6670.js";import{Q as F}from"./QTooltip.1583106e.js";import{a as I,Q as v,C as j}from"./QForm.c1fbe4fa.js";import{Q as A}from"./QFile.0197aac6.js";import{Q as M}from"./use-key-composition.35068efe.js";import"./position-engine.e3644d97.js";import"./use-prevent-scroll.95c3e0ff.js";import"./QChip.006d309c.js";import"./format.2a3572e1.js";const P={class:"text-center",id:"admin-news"},R=l("h3",null,"\u6700\u65B0\u6D88\u606F\u7BA1\u7406",-1),T={class:"div q-px-xl row"},$={class:"col-12"},E={class:"q-px-xl q-mt-md"},H={style:{width:"80%",height:"500px","border-radius":"30px","background-color":"rgb(255, 245, 238)",padding:"20px"}},O=["src"],X={class:"div q-pa-md row",align:"left"},z={class:"text-center"},G={class:"col-12"},J={class:"col-12"},K={class:"col-5"},L=l("div",{class:"row"},null,-1),de={__name:"NewsView",setup(W){const _={required(i){return!!i||"\u6B04\u4F4D\u5FC5\u586B"}},V=()=>{e.image=[]},a=h([]),e=h({_id:"",title:"",image:void 0,description:""}),Q=i=>{i===-1&&(e.title="",e.image=void 0,e.description=""),e.dialog=!0},y=()=>{e.title="",e.image=void 0,e.description=""},q=async()=>{var t,o;e.loading=!0;const i=new FormData;i.append("title",e.title),i.append("description",e.description),i.append("image",e.image);try{if(e._id.length===0){const{data:d}=await p.post("/news",i);a.push(d.result),u.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:d}=await p.patch("/news/"+e._id,i);a[0]=d.result,u.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(d){u.fire({icon:"error",title:"\u5931\u6557",text:((o=(t=d==null?void 0:d.response)==null?void 0:t.data)==null?void 0:o.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var i,t;try{const{data:o}=await p.get("/news");a.push(...o.result),e._id=a[0]._id,e.title=a[0].title,e.image=a[0].image,e.description=a[0].description,console.log(e)}catch(o){u.fire({icon:"error",title:"\u5931\u6557",text:((t=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:t.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(i,t)=>{var o,d,f;return x(),C("div",P,[R,l("div",T,[l("div",$,[s(m,{onClick:t[0]||(t[0]=r=>Q(e._id.length>0?0:-1)),color:"primary",label:"\u7DE8\u8F2F"})])]),l("div",E,[l("div",H,[l("h5",null,"\u6A19\u984C\uFF1A "+g((o=a[0])==null?void 0:o.title),1),l("h6",null,"\u5167\u5BB9\uFF1A "+g((d=a[0])==null?void 0:d.description),1),l("h6",null,[w("\u5716\u7247\uFF1A"),l("img",{src:(f=a[0])==null?void 0:f.image,style:{height:"100px"}},null,8,O)])]),s(M,{align:"center",modelValue:e.dialog,"onUpdate:modelValue":t[4]||(t[4]=r=>e.dialog=r),persistent:""},{default:n(()=>[s(k,{class:"column",style:{width:"700px","max-width":"80vw"}},{default:n(()=>[s(I,{onSubmit:q,onReset:y},{default:n(()=>[s(b,{class:"row flex justify-between"},{default:n(()=>[l("div",X,[l("div",z,g(e._id.length>0?"\u7DE8\u8F2F\u95DC\u65BC\u6211\u5011":"\u65B0\u589E\u95DC\u65BC\u6211\u5011"),1)]),B((x(),D(m,{dense:"",flat:"",icon:"close"},{default:n(()=>[s(F,null,{default:n(()=>[w("Close")]),_:1})]),_:1})),[[j]])]),_:1}),s(N,{class:"column q-gutter-md"},{default:n(()=>{var r;return[l("div",G,[s(v,{square:"",filled:"",modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=c=>e.name=c),label:"\u95DC\u65BC\u6211\u5011\u6A19\u984C",rules:[_.required]},null,8,["modelValue","rules"])]),l("div",J,[s(v,{square:"",filled:"",modelValue:e.description,"onUpdate:modelValue":t[2]||(t[2]=c=>e.description=c),type:"textarea",label:"\u95DC\u65BC\u6211\u5011\u5167\u5BB9",rules:[_.required]},null,8,["modelValue","rules"])]),l("div",K,[L,s(S,{src:(r=a[e.idx])==null?void 0:r.image,style:{height:"100px"}},null,8,["src"]),s(A,{filled:"",modelValue:e.image,"onUpdate:modelValue":t[3]||(t[3]=c=>e.image=c),label:"\u8ACB\u4E0A\u50B3\u5716\u7247",style:{"max-height":"50px"}},{append:n(()=>[s(U,{name:"close",onClick:V})]),_:1},8,["modelValue"])])]}),_:1}),s(b,{align:"right"},{default:n(()=>[s(m,{disabled:e.loading,flat:"",label:"reset",type:"reset",color:"red"},null,8,["disabled"]),s(m,{disabled:e.loading,flat:"",label:"submit",type:"submit",color:"green"},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])}}};export{de as default};
