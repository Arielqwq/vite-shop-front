import{M as g,r as q,aM as f,aH as u,j as _,k as y,l as d,d as o,N as i,Q as x,C as m,a0 as C,aP as b,a1 as k,X as U,V as S,$ as B,aO as D}from"./index.467e0a25.js";import{Q as r,a as N,C as T}from"./QForm.54f56720.js";import{Q as I}from"./QTd.f5957888.js";import{Q as $}from"./QTable.155f9cd7.js";import{Q as j}from"./QTooltip.47cf4c74.js";import{Q as A}from"./QCheckbox.70bf8d02.js";import{Q as F}from"./use-key-composition.3465fa51.js";import"./QSeparator.4b948942.js";import"./QMenu.fd030325.js";import"./position-engine.6a9cec7f.js";import"./use-prevent-scroll.be416be6.js";import"./QChip.d5b7e8a4.js";import"./QItemLabel.284c4d5f.js";import"./format.2a3572e1.js";const M={id:"customersview"},P=d("h3",{class:"text-center"},"\u6703\u54E1\u7BA1\u7406",-1),R=d("div",{class:"div q-px-xl row"},null,-1),E={class:"div q-px-xl q-mt-md"},H={class:"div q-pa-md row",align:"left"},O={class:"text-center"},X={class:"col-12"},z={class:"col-12"},G={class:"col-12"},J={class:"col-12"},K={class:"col-2"},me={__name:"CustomersView",setup(L){const s=g([]),c=q(""),p={required(l){return!!l||"\u6B04\u4F4D\u5FC5\u586B"}},e=g({_id:"",account:"",password:"",email:0,name:"",phone:"",sell:"",loading:!1,dialog:!1,idx:-1}),w=l=>{l===-1?(e._id="",e.account="",e.password="",e.email="",e.name="",e.phone="",e.sell="",e.loading=!1,e.dialog=!1,e.idx=-1):(e._id=s[l]._id,e.account=s[l].account,e.password=s[l].password,e.email=s[l].email,e.name=s[l].name,e.phone=s[l].phone,e.sell=s[l].sell,e.loading=s[l].loading,e.dialog=s[l].dialog,e.idx=l),e.dialog=!0},V=[{name:"account",required:!0,label:"\u5E33\u865F",align:"left",field:l=>l.account},{name:"email",required:!0,label:"\u4FE1\u7BB1",align:"left",field:l=>l.email,format:l=>`${l}`,sortable:!0},{name:"name",label:"name",align:"left",field:l=>l.daysfrom},{name:"phone",label:"\u9023\u7D61\u96FB\u8A71",align:"left",field:l=>l.daysto},{name:"sell",required:!0,label:"\u72C0\u614B",align:"left",field:l=>l.sell},{name:"edit",label:"\u7DE8\u8F2F",align:"left"}],h=()=>{e.account=null,e.email=null,e.name=null,e.phone=null,e.sell=!1,e.image=void 0},v=async()=>{var t,a;e.loading=!0;const l=new FormData;l.append("title",e.title);try{if(e._id.length===0){const{data:n}=await f.post("/users",l);s.push(n.result),u.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6D3B\u52D5\u6210\u529F"}),console.log(s)}else{const{data:n}=await f.patch("/users/"+e._id,l);s[e.idx]=n.result,u.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6703\u54E1\u8CC7\u6599\u6210\u529F"})}e.dialog=!1}catch(n){u.fire({icon:"error",title:"\u5931\u6557",text:((a=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:a.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var l,t;try{const{data:a}=await f.get("/users/all");s.push(...a.result),console.log(s)}catch(a){console.log(a),u.fire({icon:"error",title:"\u5931\u6557",text:((t=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:t.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(l,t)=>(_(),y("div",M,[P,R,d("div",E,[o($,{columns:V,rows:s,"row-key":"_id",filter:c.value,"rows-per-page-options":[5]},{"top-right":i(()=>[o(r,{borderless:"",dense:"",debounce:"300",modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=a=>c.value=a),placeholder:"Search"},{append:i(()=>[o(x,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-edit":i(a=>[o(I,{class:"q-pa-md q-gutter-sm"},{default:i(()=>[o(m,{round:"",color:"primary","text-color":"white",icon:"edit",onClick:n=>w(s.findIndex(Q=>Q._id===a.row._id))},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows","filter"]),o(F,{align:"center",modelValue:e.dialog,"onUpdate:modelValue":t[6]||(t[6]=a=>e.dialog=a),persistent:""},{default:i(()=>[o(C,{class:"column",style:{width:"700px","max-width":"80vw"}},{default:i(()=>[o(N,{onSubmit:v,onReset:h},{default:i(()=>[o(b,{class:"row flex justify-between"},{default:i(()=>[d("div",H,[d("div",O,k(e._id.length>0?"\u7DE8\u8F2F\u5E33\u865F":"\u65B0\u589E\u5E33\u865F"),1)]),U((_(),S(m,{dense:"",flat:"",icon:"close"},{default:i(()=>[o(j,null,{default:i(()=>[B("Close")]),_:1})]),_:1})),[[T]])]),_:1}),o(D,{class:"column q-gutter-md"},{default:i(()=>[d("div",X,[o(r,{square:"",filled:"",modelValue:e.account,"onUpdate:modelValue":t[1]||(t[1]=a=>e.account=a),label:"\u5E33\u865F",rules:[p.required]},null,8,["modelValue","rules"])]),d("div",z,[o(r,{square:"",filled:"",modelValue:e.password,"onUpdate:modelValue":t[2]||(t[2]=a=>e.password=a),type:"number",label:"\u5BC6\u78BC",rules:[p.required]},null,8,["modelValue","rules"])]),d("div",G,[o(r,{square:"",filled:"",modelValue:e.email,"onUpdate:modelValue":t[3]||(t[3]=a=>e.email=a),type:"email",label:"\u4FE1\u7BB1",rules:[p.required]},null,8,["modelValue","rules"])]),d("div",J,[o(r,{square:"",filled:"",modelValue:e.name,"onUpdate:modelValue":t[4]||(t[4]=a=>e.name=a),type:"text",label:"\u59D3\u540D"},null,8,["modelValue"])]),d("div",K,[o(A,{modelValue:e.sell,"onUpdate:modelValue":t[5]||(t[5]=a=>e.sell=a),label:"\u72C0\u614B"},null,8,["modelValue"])])]),_:1}),o(b,{align:"right"},{default:i(()=>[o(m,{disabled:e.loading,flat:"",label:"reset",type:"reset",color:"red"},null,8,["disabled"]),o(m,{disabled:e.loading,flat:"",label:"submit",type:"submit",color:"green"},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]))}};export{me as default};
