import{M as g,r as q,aM as f,aH as u,j as _,k as x,l as n,d as t,N as i,Q as y,C as m,a0 as C,aP as b,a1 as k,X as U,V as S,$ as B,aO as D}from"./index.d65890ce.js";import{Q as r,a as N,C as T}from"./QForm.ffe3ee3a.js";import{Q as I,a as $}from"./QTable.776c378f.js";import{Q as j}from"./QTooltip.0c855914.js";import{Q as A}from"./QCheckbox.61e1d519.js";import{Q as F}from"./use-key-composition.e5e45876.js";import"./QSeparator.af0590bf.js";import"./QMenu.2d6a8680.js";import"./position-engine.7f17bd70.js";import"./use-prevent-scroll.2c9c4867.js";import"./QChip.ac7192c3.js";import"./QItemLabel.daa3acab.js";import"./format.2a3572e1.js";const M={id:"customersview"},P=n("h3",{class:"text-center"},"\u6703\u54E1\u7BA1\u7406",-1),R=n("div",{class:"div q-px-xl row"},null,-1),E={class:"div q-px-xl q-mt-md"},H={class:"div q-pa-md row",align:"left"},O={class:"text-center"},X={class:"col-12"},z={class:"col-12"},G={class:"col-12"},J={class:"col-12"},K={class:"col-2"},ue={__name:"CustomersView",setup(L){const s=g([]),c=q(""),p={required(l){return!!l||"\u6B04\u4F4D\u5FC5\u586B"}},e=g({_id:"",account:"",password:"",email:0,name:"",phone:"",sell:"",loading:!1,dialog:!1,idx:-1}),w=l=>{l===-1?(e._id="",e.account="",e.password="",e.email="",e.name="",e.phone="",e.sell="",e.loading=!1,e.dialog=!1,e.idx=-1):(e._id=s[l]._id,e.account=s[l].account,e.password=s[l].password,e.email=s[l].email,e.name=s[l].name,e.phone=s[l].phone,e.sell=s[l].sell,e.loading=s[l].loading,e.dialog=s[l].dialog,e.idx=l),e.dialog=!0},V=[{name:"account",required:!0,label:"\u5E33\u865F",align:"left",field:l=>l.account},{name:"email",required:!0,label:"\u4FE1\u7BB1",align:"left",field:l=>l.email,format:l=>`${l}`,sortable:!0},{name:"username",label:"\u6703\u54E1\u59D3\u540D",align:"left",field:l=>l.username},{name:"phone",label:"\u9023\u7D61\u96FB\u8A71",align:"left",field:l=>l.phone},{name:"edit",label:"\u7DE8\u8F2F",align:"left"}],h=()=>{e.account=null,e.email=null,e.name=null,e.phone=null,e.sell=!1,e.image=void 0},v=async()=>{var o,a;e.loading=!0;const l=new FormData;l.append("title",e.title);try{if(e._id.length===0){const{data:d}=await f.post("/users",l);s.push(d.result),u.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6D3B\u52D5\u6210\u529F"}),console.log(s)}else{const{data:d}=await f.patch("/users/"+e._id,l);s[e.idx]=d.result,u.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6703\u54E1\u8CC7\u6599\u6210\u529F"})}e.dialog=!1}catch(d){u.fire({icon:"error",title:"\u5931\u6557",text:((a=(o=d==null?void 0:d.response)==null?void 0:o.data)==null?void 0:a.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var l,o;try{const{data:a}=await f.get("/users/all");s.push(...a.result),console.log(s)}catch(a){console.log(a),u.fire({icon:"error",title:"\u5931\u6557",text:((o=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:o.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(l,o)=>(_(),x("div",M,[P,R,n("div",E,[t(I,{columns:V,rows:s,"row-key":"_id",filter:c.value,"rows-per-page-options":[5]},{"top-right":i(()=>[t(r,{borderless:"",dense:"",debounce:"300",modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=a=>c.value=a),placeholder:"Search"},{append:i(()=>[t(y,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-edit":i(a=>[t($,{class:"q-pa-md q-gutter-sm"},{default:i(()=>[t(m,{round:"",color:"primary","text-color":"white",icon:"edit",onClick:d=>w(s.findIndex(Q=>Q._id===a.row._id))},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows","filter"]),t(F,{align:"center",modelValue:e.dialog,"onUpdate:modelValue":o[6]||(o[6]=a=>e.dialog=a),persistent:""},{default:i(()=>[t(C,{class:"column",style:{width:"700px","max-width":"80vw"}},{default:i(()=>[t(N,{onSubmit:v,onReset:h},{default:i(()=>[t(b,{class:"row flex justify-between"},{default:i(()=>[n("div",H,[n("div",O,k(e._id.length>0?"\u7DE8\u8F2F\u5E33\u865F":"\u65B0\u589E\u5E33\u865F"),1)]),U((_(),S(m,{dense:"",flat:"",icon:"close"},{default:i(()=>[t(j,null,{default:i(()=>[B("Close")]),_:1})]),_:1})),[[T]])]),_:1}),t(D,{class:"column q-gutter-md"},{default:i(()=>[n("div",X,[t(r,{square:"",filled:"",modelValue:e.account,"onUpdate:modelValue":o[1]||(o[1]=a=>e.account=a),label:"\u5E33\u865F",rules:[p.required]},null,8,["modelValue","rules"])]),n("div",z,[t(r,{square:"",filled:"",modelValue:e.password,"onUpdate:modelValue":o[2]||(o[2]=a=>e.password=a),type:"number",label:"\u5BC6\u78BC",rules:[p.required]},null,8,["modelValue","rules"])]),n("div",G,[t(r,{square:"",filled:"",modelValue:e.email,"onUpdate:modelValue":o[3]||(o[3]=a=>e.email=a),type:"email",label:"\u4FE1\u7BB1",rules:[p.required]},null,8,["modelValue","rules"])]),n("div",J,[t(r,{square:"",filled:"",modelValue:e.name,"onUpdate:modelValue":o[4]||(o[4]=a=>e.name=a),type:"text",label:"\u59D3\u540D"},null,8,["modelValue"])]),n("div",K,[t(A,{modelValue:e.sell,"onUpdate:modelValue":o[5]||(o[5]=a=>e.sell=a),label:"\u72C0\u614B"},null,8,["modelValue"])])]),_:1}),t(b,{align:"right"},{default:i(()=>[t(m,{disabled:e.loading,flat:"",label:"reset",type:"reset",color:"red"},null,8,["disabled"]),t(m,{disabled:e.loading,flat:"",label:"submit",type:"submit",color:"green"},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]))}};export{ue as default};
